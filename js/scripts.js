var isNewVisitor=function(){if(sessionStorage.getItem("newVisitor"))for(var e=document.querySelectorAll(".hasAnimation"),t=0;t<e.length;t++)e[t].style.animation="none";else sessionStorage.setItem("newVisitor",!1)};function navFunc(){var e=document.getElementById("navi");"nav"===e.className?e.className+=" responsive":e.className="nav"}var numberOfStars=21,starfield=document.querySelector(".starfield"),starImg=document.querySelector(".star"),newStar,createStar=function(e){e.classList.add("twinkle");var t=Math.floor(100*Math.random()),a=Math.floor(100*Math.random()),n=Math.floor(6*Math.random())+1;(e=e.cloneNode(!0)).style.top="".concat(t,"%"),e.style.left="".concat(a,"%"),e.style.width="".concat(n,"rem"),starfield.appendChild(e)},randomTime=function(){return Math.floor(3e3*Math.random())+2e3},removeFinishedStar=function(){for(var e=document.getElementsByClassName("star"),t=0;t<=e.length-4;t++)e[t].remove()},errorHappened,intervalId;function loop(){createStar(starImg),clearInterval(timer),timer=setInterval(loop,randomTime())}function openImage(selection,quickZoom){var modal=document.getElementById(selection),modalImg=document.getElementById("".concat(selection,"_img"));function keyRoll(e){"37"==e.keyCode?eval(modal.childNodes[1].getAttribute("onclick")):"39"==e.keyCode&&eval(modal.childNodes[2].getAttribute("onclick"))}quickZoom?(modal.classList.add("fadeIn"),modalImg.classList.add("quickZoom")):(modal.classList.remove("fadeIn"),modalImg.classList.remove("quickZoom")),document.onkeydown=keyRoll,modal.style.display="flex",modal.childNodes[0].onclick=function(){modal.style.display="none",removeEventListener("click",handler,!1),document.onkeydown=null};var handler=function e(t){t.target==modal&&(modal.style.display="none",document.onkeydown=null,removeEventListener("click",e,!1))};addEventListener("click",handler,!1)}"function"!=typeof NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);var getSpeksiData=function(){var e=new XMLHttpRequest;e.open("GET","assets/speksit.json",!0),e.onload=function(){var e;200<=this.status&&this.status<400?(e=JSON.parse(this.response),buildSpeksit(e)):console.log(this.response)},e.onerror=function(){console.log(this.response)},e.send()},buildSpeksit=function(e){var f=document.getElementById("posters");e.map(function(e){var t=e.year,a=document.createElement("a");a.setAttribute("id","".concat(e.id)),a.setAttribute("href","#speksi"),a.setAttribute("onclick","showSpeksi(this.id)"),a.classList.add("poster"),a.setAttribute("year","".concat(e.year));var n=document.createElement("div");n.classList.add("poster__container");var d=document.createElement("img");d.classList.add("poster__container__img"),d.setAttribute("src","img/db/".concat(t,"/").concat(e.poster)),d.setAttribute("alt","".concat(e.name));var c=document.createElement("p");c.classList.add("poster__year"),c.appendChild(document.createTextNode("".concat(e.year))),document.createTextNode("".concat(e.name));var o=document.createElement("h3");o.classList.add("poster__title"),o.appendChild(document.createTextNode("".concat(e.name))),a.appendChild(n),n.appendChild(d),a.appendChild(c),a.appendChild(o),f.appendChild(a),document.getElementById("loading").style.display="none";c=document.querySelector("#".concat(e.id,"__container .speksi__content")),o=document.createElement("img");o.setAttribute("src","img/db/".concat(t,"/").concat(e.banner)),o.classList.add("speksi__content__banner"),o.setAttribute("alt","".concat(e.name)),c.appendChild(o);a=document.createElement("div");a.classList.add("speksi__title"),a.classList.add("flex");o=document.createElement("h2");o.classList.add("heading"),o.classList.add("heading__h2"),o.appendChild(document.createTextNode("".concat(e.name))),a.appendChild(o),c.appendChild(a);var s,i=document.createElement("div");i.classList.add("speksi__statistics"),i.classList.add("flex"),e.statistics.map(function(t){var e=document.createElement("p");e.classList.add("speksi__statistics__item"),e.appendChild(document.createTextNode("".concat(Object.keys(t),": ")));var a=document.createElement("span");a.appendChild(document.createTextNode("".concat(Object.keys(t).map(function(e){return t[e]})))),e.appendChild(a),i.appendChild(e)}),c.appendChild(i),e.generateText&&((s=document.createElement("div")).classList.add("speksi__synopsis"),e.text.map(function(e){var t=document.createElement("p");t.classList.add("paragraph"),t.appendChild(document.createTextNode("".concat(e))),s.appendChild(t)}),c.appendChild(s));var l=document.createElement("div");l.classList.add("speksi__resources"),l.classList.add("flex");for(var r=0;r<e.resources.length;r++){var m=document.createElement("a");m.classList.add("button"),m.classList.add("button__speksi"),m.setAttribute("href","".concat(e.resources[r].url)),m.setAttribute("target","_blank"),m.setAttribute("rel","noreferrer"),m.appendChild(document.createTextNode("".concat(e.resources[r].title))),l.appendChild(m)}c.appendChild(l);var u=document.createElement("div");u.classList.add("speksi__images"),u.classList.add("flex");for(var p=1;p<=e.images;p++){var h=document.createElement("img"),g=document.createElement("img");h.setAttribute("src","img/arrow_left.svg"),g.setAttribute("src","img/arrow_right.svg"),h.setAttribute("alt","Edellinen kuva"),g.setAttribute("alt","Seuraava kuva"),h.classList.add("arrow"),h.classList.add("arrow__left"),g.classList.add("arrow"),g.classList.add("arrow__right"),h.setAttribute("onclick","rollImages('".concat(e.year,"', ").concat(e.images,", ").concat(p,", 'left')")),g.setAttribute("onclick","rollImages('".concat(e.year,"', ").concat(e.images,", ").concat(p,", 'right')"));var _=document.createElement("div");_.classList.add("speksi__images__item");var v=document.createElement("div");v.classList.add("speksi__images__item__thumb"),v.classList.add("lazyload"),v.setAttribute("data-src","img/db/".concat(t,"/").concat(e.year,"_").concat(p,"_thumb.jpg")),v.setAttribute("style","background-image:url(img/loading.svg)"),v.setAttribute("style","background-size:cover"),v.setAttribute("onclick","openImage('".concat(e.year,"_").concat(p,"_modal', true)")),_.appendChild(v),u.appendChild(_);var y=document.createElement("div");y.setAttribute("id","".concat(e.year,"_").concat(p,"_modal")),y.classList.add("modal");v=document.createElement("span");v.classList.add("modal__close");_=document.createElement("span");_.classList.add("modal__close__icon"),_.appendChild(document.createTextNode(String.fromCharCode(160))),v.appendChild(_),y.appendChild(v),y.appendChild(h),y.appendChild(g);g=document.createElement("img");g.setAttribute("id","".concat(e.year,"_").concat(p,"_modal_img")),g.setAttribute("data-src","img/db/".concat(t,"/").concat(e.year,"_").concat(p,".jpg")),g.setAttribute("src","img/loading.svg"),g.classList.add("lazyload"),g.setAttribute("alt","".concat(e.name," -valokuva #").concat(p)),g.classList.add("modal__image"),g.classList.add("modal__image__".concat(t)),y.appendChild(g),document.getElementById("modals").appendChild(y)}c.appendChild(u)}),lazyload(),addPosterClickListeners()},showSpeksi=function(e,t){for(var a=document.querySelectorAll(".speksi"),n=document.getElementById("".concat(e,"__container")).getAttribute("id"),d=0;d<a.length;d++)a[d].getAttribute("id")==n?(a[d].style.display="flex",a[d].classList.add("fadeIn")):a[d].style.display="none"},rollImages=function(e,t,a,n){"".concat(e,"_").concat(a,"__modal");var d=document.getElementById("".concat(e,"_").concat(a,"_modal"));"left"==n?(n=1==a?t:a-1,openImage("".concat(e,"_").concat(n,"_modal"),!1)):(a=a==t?1:a+1,openImage("".concat(e,"_").concat(a,"_modal"),!1)),d.style.display="none"},removeLazyload=function(e){var t=document.getElementById("".concat(e,"_img")),e=t.getAttribute("data-src");t.style.backgroundImage="url('".concat(e,"')");t=document.createElement("link");t.setAttribute("rel","preload"),t.setAttribute("as","image"),t.setAttribute("href","".concat(e)),document.getElementsByTagName("head")[0].appendChild(t)},addPosterClickListeners=function(){for(var t=document.querySelectorAll(".poster"),e=0;e<t.length;e++)!function(e){t[e].addEventListener("click",function(){activeYear=t[e].getAttribute("year"),startImageDownload(activeYear)})}(e)},startImageDownload=function(e){intervalId&&clearInterval(intervalId);var t=document.querySelectorAll(".modal__image__".concat(e)),a=t.length,n=0;intervalId=setInterval(function(){n<a&&t[n].getAttribute("data-src")!=t[n].getAttribute("src")?(t[n].setAttribute("src",t[n].getAttribute("data-src")),n++):clearInterval(intervalId)},1e3)},getYhdistysData=function(){var e=new XMLHttpRequest;e.open("GET","assets/yhdistys.json",!0),e.onload=function(){var e;200<=this.status&&this.status<400?(e=JSON.parse(this.response),buildTables(e)):console.log(this.response)},e.onerror=function(){console.log(this.response)},e.send()},buildTables=function(e){var c=document.getElementById("people");e.map(function(e){var t=document.createElement("h2");t.classList.add("heading"),t.classList.add("heading__h2"),t.setAttribute("id","".concat(e.id)),t.appendChild(document.createTextNode("".concat(e.tableName))),c.appendChild(t);var d=document.createElement("table");d.classList.add("table");var a=document.createElement("tr"),n=document.createElement("th"),t=document.createElement("th");n.appendChild(document.createTextNode("Tehtävä:")),t.appendChild(document.createTextNode("Nimi:")),a.appendChild(n),a.appendChild(t),d.appendChild(a),c.appendChild(d),e.people.map(function(e){var t=document.createElement("tr"),a=document.createElement("td");a.classList.add("table__title"),a.appendChild(document.createTextNode("".concat(e.title,":"))),t.appendChild(a);var n=document.createElement("td");n.classList.add("table__name"),e.email?((a=document.createElement("a")).setAttribute("href","mailto:".concat(e.email)),a.classList.add("table__link"),a.appendChild(document.createTextNode("".concat(e.name))),n.appendChild(a)):n.appendChild(document.createTextNode("".concat(e.name))),t.appendChild(n),d.appendChild(t),c.appendChild(d)})}),document.getElementById("loading").style.display="none"};