var isNewVisitor=function(){if(sessionStorage.getItem("newVisitor"))for(var e=document.querySelectorAll(".hasAnimation"),t=0;t<e.length;t++)e[t].style.animation="none";else sessionStorage.setItem("newVisitor",!1)};function navFunc(){var e=document.getElementById("navi");"nav"===e.className?e.className+=" responsive":e.className="nav"}var numberOfStars=21,starfield=document.querySelector(".starfield"),starImg=document.querySelector(".star"),newStar,createStar=function(e){e.classList.add("twinkle");var t=Math.floor(100*Math.random()),a=Math.floor(100*Math.random()),n=Math.floor(6*Math.random())+1;(e=e.cloneNode(!0)).style.top="".concat(t,"%"),e.style.left="".concat(a,"%"),e.style.width="".concat(n,"rem"),starfield.appendChild(e)},randomTime=function(){var e=Math.floor(3e3*Math.random())+2e3;return e},removeFinishedStar=function(){for(var e=document.getElementsByClassName("star"),t=0;t<=e.length-4;t++)e[t].remove()},errorHappened,intervalId;function loop(){createStar(starImg),clearInterval(timer),timer=setInterval(loop,randomTime())}function openImage(selection,quickZoom){var modal=document.getElementById(selection),modalImg=document.getElementById("".concat(selection,"_img"));function keyRoll(e){e=e,"37"==e.keyCode?eval(modal.childNodes[1].getAttribute("onclick")):"39"==e.keyCode&&eval(modal.childNodes[2].getAttribute("onclick"))}quickZoom?(modal.classList.add("fadeIn"),modalImg.classList.add("quickZoom")):(modal.classList.remove("fadeIn"),modalImg.classList.remove("quickZoom")),document.onkeydown=keyRoll,modal.style.display="flex",modal.childNodes[0].onclick=function(){modal.style.display="none",removeEventListener("click",handler,!1),document.onkeydown=null};var handler=function e(t){t.target==modal&&(modal.style.display="none",document.onkeydown=null,removeEventListener("click",e,!1))};addEventListener("click",handler,!1)}!function(){if("function"==typeof NodeList.prototype.forEach)return!1;NodeList.prototype.forEach=Array.prototype.forEach}();var getSpeksiData=function(){var e=new XMLHttpRequest;e.open("GET","assets/speksit.json",!0),e.onload=function(){if(this.status>=200&&this.status<400){var e=JSON.parse(this.response);buildSpeksit(e)}else console.log(this.response)},e.onerror=function(){console.log(this.response)},e.send()},buildSpeksit=function(e){var t=document.getElementById("posters");e.map(function(e){var a=e.year,n=document.createElement("a");n.setAttribute("id","".concat(e.id)),n.setAttribute("href","#speksi"),n.setAttribute("onclick","showSpeksi(this.id)"),n.classList.add("poster"),n.setAttribute("year","".concat(e.year));var d=document.createElement("div");d.classList.add("poster__container");var c=document.createElement("img");c.classList.add("poster__container__img"),c.setAttribute("src","img/db/".concat(a,"/").concat(e.poster)),c.setAttribute("alt","".concat(e.name));var o=document.createElement("p");o.classList.add("poster__year"),o.appendChild(document.createTextNode("".concat(e.year))),document.createTextNode("".concat(e.name));var s=document.createElement("h3");s.classList.add("poster__title"),s.appendChild(document.createTextNode("".concat(e.name))),n.appendChild(d),d.appendChild(c),n.appendChild(o),n.appendChild(s),t.appendChild(n),document.getElementById("loading").style.display="none";var i=document.querySelector("#".concat(e.id,"__container .speksi__content")),l=document.createElement("img");l.setAttribute("src","img/db/".concat(a,"/").concat(e.banner)),l.classList.add("speksi__content__banner"),l.setAttribute("alt","".concat(e.name)),i.appendChild(l);var r=document.createElement("div");r.classList.add("speksi__title"),r.classList.add("flex");var m=document.createElement("h2");m.classList.add("heading"),m.classList.add("heading__h2"),m.appendChild(document.createTextNode("".concat(e.name))),r.appendChild(m),i.appendChild(r);var u=document.createElement("div");if(u.classList.add("speksi__statistics"),u.classList.add("flex"),e.statistics.map(function(e){var t=document.createElement("p");t.classList.add("speksi__statistics__item"),t.appendChild(document.createTextNode("".concat(Object.keys(e),": ")));var a=document.createElement("span");a.appendChild(document.createTextNode("".concat(Object.keys(e).map(function(t){return e[t]})))),t.appendChild(a),u.appendChild(t)}),i.appendChild(u),e.generateText){var p=document.createElement("div");p.classList.add("speksi__synopsis"),e.text.map(function(e){var t=document.createElement("p");t.classList.add("paragraph"),t.appendChild(document.createTextNode("".concat(e))),p.appendChild(t)}),i.appendChild(p)}var h=document.createElement("div");h.classList.add("speksi__resources"),h.classList.add("flex");for(var g=0;g<e.resources.length;g++){var v=document.createElement("a");v.classList.add("button"),v.classList.add("button__speksi"),v.setAttribute("href","".concat(e.resources[g].url)),v.setAttribute("target","_blank"),v.setAttribute("rel","noreferrer"),v.appendChild(document.createTextNode("".concat(e.resources[g].title))),h.appendChild(v)}i.appendChild(h);var _=document.createElement("div");_.classList.add("speksi__images"),_.classList.add("flex");for(var f=1;f<=e.images;f++){var y=document.createElement("img"),b=document.createElement("img");y.setAttribute("src","img/arrow_left.svg"),b.setAttribute("src","img/arrow_right.svg"),y.setAttribute("alt","Edellinen kuva"),b.setAttribute("alt","Seuraava kuva"),y.classList.add("arrow"),y.classList.add("arrow__left"),b.classList.add("arrow"),b.classList.add("arrow__right"),y.setAttribute("onclick","rollImages('".concat(e.year,"', ").concat(e.images,", ").concat(f,", 'left')")),b.setAttribute("onclick","rollImages('".concat(e.year,"', ").concat(e.images,", ").concat(f,", 'right')"));var C=document.createElement("div");C.classList.add("speksi__images__item");var E=document.createElement("div");E.classList.add("speksi__images__item__thumb"),E.classList.add("lazyload"),E.setAttribute("data-src","img/db/".concat(a,"/").concat(e.year,"_").concat(f,"_thumb.jpg")),E.setAttribute("style","background-image:url(img/loading.svg)"),E.setAttribute("style","background-size:cover"),E.setAttribute("onclick","openImage('".concat(e.year,"_").concat(f,"_modal', true)")),C.appendChild(E),_.appendChild(C);var L=document.createElement("div");L.setAttribute("id","".concat(e.year,"_").concat(f,"_modal")),L.classList.add("modal");var k=document.createElement("span");k.classList.add("modal__close");var A=document.createElement("span");A.classList.add("modal__close__icon"),A.appendChild(document.createTextNode(String.fromCharCode(160))),k.appendChild(A),L.appendChild(k),L.appendChild(y),L.appendChild(b);var I=document.createElement("img");I.setAttribute("id","".concat(e.year,"_").concat(f,"_modal_img")),I.setAttribute("data-src","img/db/".concat(a,"/").concat(e.year,"_").concat(f,".jpg")),I.setAttribute("src","img/loading.svg"),I.classList.add("lazyload"),I.setAttribute("alt","".concat(e.name," -valokuva #").concat(f)),I.classList.add("modal__image"),I.classList.add("modal__image__".concat(a)),L.appendChild(I),document.getElementById("modals").appendChild(L)}i.appendChild(_)}),lazyload(),addPosterClickListeners()},showSpeksi=function(e,t){for(var a=document.querySelectorAll(".speksi"),n=document.getElementById("".concat(e,"__container")).getAttribute("id"),d=0;d<a.length;d++)a[d].getAttribute("id")==n?(a[d].style.display="flex",a[d].classList.add("fadeIn")):a[d].style.display="none"},rollImages=function(e,t,a,n){"".concat(e,"_").concat(a,"__modal");var d,c,o=document.getElementById("".concat(e,"_").concat(a,"_modal"));"left"==n?(c=1==a?t:a-1,openImage("".concat(e,"_").concat(c,"_modal"),!1)):(d=a==t?1:a+1,openImage("".concat(e,"_").concat(d,"_modal"),!1)),o.style.display="none"},removeLazyload=function(e){var t=document.getElementById("".concat(e,"_img")),a=t.getAttribute("data-src");t.style.backgroundImage="url('".concat(a,"')");var n=document.createElement("link");n.setAttribute("rel","preload"),n.setAttribute("as","image"),n.setAttribute("href","".concat(a)),document.getElementsByTagName("head")[0].appendChild(n)},addPosterClickListeners=function(){for(var e=document.querySelectorAll(".poster"),t=function(t){e[t].addEventListener("click",function(){activeYear=e[t].getAttribute("year"),startImageDownload(activeYear)})},a=0;a<e.length;a++)t(a)},startImageDownload=function(e){intervalId&&clearInterval(intervalId);var t=document.querySelectorAll(".modal__image__".concat(e)),a=t.length,n=0;intervalId=setInterval(function(){n<a&&t[n].getAttribute("data-src")!=t[n].getAttribute("src")?(t[n].setAttribute("src",t[n].getAttribute("data-src")),n++):clearInterval(intervalId)},1e3)},getYhdistysData=function(){var e=new XMLHttpRequest;e.open("GET","assets/yhdistys.json",!0),e.onload=function(){if(this.status>=200&&this.status<400){var e=JSON.parse(this.response);buildTables(e)}else console.log(this.response)},e.onerror=function(){console.log(this.response)},e.send()},buildTables=function(e){var t=document.getElementById("people");e.map(function(e){var a=document.createElement("h2");a.classList.add("heading"),a.classList.add("heading__h2"),a.setAttribute("id","".concat(e.id)),a.appendChild(document.createTextNode("".concat(e.tableName))),t.appendChild(a);var n=document.createElement("table");n.classList.add("table");var d=document.createElement("tr"),c=document.createElement("th"),o=document.createElement("th");c.appendChild(document.createTextNode("Tehtävä:")),o.appendChild(document.createTextNode("Nimi:")),d.appendChild(c),d.appendChild(o),n.appendChild(d),t.appendChild(n),e.people.map(function(e){var a=document.createElement("tr"),d=document.createElement("td");d.classList.add("table__title"),d.appendChild(document.createTextNode("".concat(e.title,":"))),a.appendChild(d);var c=document.createElement("td");if(c.classList.add("table__name"),e.email){var o=document.createElement("a");o.setAttribute("href","mailto:".concat(e.email)),o.classList.add("table__link"),o.appendChild(document.createTextNode("".concat(e.name))),c.appendChild(o)}else c.appendChild(document.createTextNode("".concat(e.name)));a.appendChild(c),n.appendChild(a),t.appendChild(n)})}),document.getElementById("loading").style.display="none"};